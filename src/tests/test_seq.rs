// Create random sequences for the query and the data time series
// The observations are of type f64
// The tuple "query_rng" describes the min and max length of the query
// If a tuple "data_rng" was provided, it describes the min and max length of the data sequence
// Otherwise the data sequence has the same length as the query
pub fn make_rdm_series(
    query_rng: (u32, u32),
    data_rng: Option<(u32, u32)>,
) -> (std::vec::Vec<f64>, std::vec::Vec<f64>) {
    use rand::thread_rng;
    use rand::Rng;

    let mut rng = thread_rng();
    let query_len: u32 = rng.gen_range(query_rng.0..query_rng.1);
    let data_len: u32;
    if let Some((start, end)) = data_rng {
        data_len = rng.gen_range(start..end)
    } else {
        data_len = query_len;
    };

    let mut query = Vec::new();
    let mut data = Vec::new();

    for _ in 0..data_len {
        let observation: f64 = rand::random();
        data.push(observation);
    }
    for _ in 0..query_len {
        let observation: f64 = rand::random();
        query.push(observation);
    }

    (query, data)
}

pub fn make_rdm_params(
    query_rng: (u32, u32),
    data_rng: Option<(u32, u32)>,
) -> (
    std::vec::Vec<f64>,
    std::vec::Vec<f64>,
    std::vec::Vec<f64>,
    std::vec::Vec<f64>,
    usize,
    f64,
) {
    use rand::thread_rng;
    use rand::Rng;

    let (query, data) = make_rdm_series(query_rng, data_rng);

    let (mut cb_query, mut cb_data) = (Vec::new(), Vec::new());

    let mut rng = thread_rng();
    let mut observation: f64;
    for i in 0..query.len() {
        observation = rng.gen_range(0.0..0.1);
        if i == 0 {
            cb_query.push(observation);
        } else {
            cb_query.push(observation + cb_query[i - 1]);
        }
    }
    for i in 0..data.len() {
        observation = rand::random();
        if i == 0 {
            cb_data.push(observation);
        } else {
            cb_data.push(observation + cb_data[i - 1]);
        }
    }
    let bsf = rng.gen_range(1000.0..2000.0);

    let w = rng.gen_range(0..query.len() - 2);

    (query, data, cb_query, cb_data, w, bsf)
}

pub fn make_test_series(equal_len: bool) -> (Vec<Vec<f64>>, Vec<Vec<f64>>) {
    let a1 = vec![1.0, 1.];
    let a2 = vec![2.0, 1.];
    let a3 = vec![3.0, 1.];
    let a4 = vec![2.0, 1.];
    let a5 = vec![2.13, 1.];
    let a6 = vec![1.0, 1.];

    let b1 = vec![1.0, 1.];
    let b2 = vec![1.0, 1.];
    let b3 = vec![2.0, 1.];
    let b4 = vec![2.0, 1.];
    let b5 = vec![2.42, 1.];
    let b6 = vec![3.0, 1.];
    let b7 = vec![2.0, 1.];
    let b8 = vec![1.0, 1.];
    let mut data = Vec::new();
    data.push(a1);
    data.push(a2);
    data.push(a3);
    data.push(a4);
    data.push(a5);
    data.push(a6);

    let mut query = Vec::new();
    query.push(b1);
    query.push(b2);
    query.push(b3);
    query.push(b4);
    query.push(b5);
    query.push(b6);

    if !equal_len {
        query.push(b7);
        query.push(b8);
    }
    (query, data)
}

pub fn make_knn_fail_candidate(candidate_no: usize) -> Vec<f64> {
    let failing_candidate_1 = vec![
        -0.6201428213355223,
        -0.5728859410962197,
        -0.6234087792265741,
        -0.4270118151567179,
        -0.586208683405387,
        0.0045554996676052525,
        -0.03235286276777742,
        -0.001523333405307244,
        0.28714126252566113,
        0.30318264937729583,
        0.27730045047275065,
        0.05206894917342068,
        0.13173571709892984,
        -0.2298314989596042,
        -0.03653719001549565,
        0.40279430552296774,
        0.21560166806399333,
        0.44777325952651,
        0.7871026540733933,
        0.3558437525231183,
        -0.03407735230862473,
        0.12047364684090218,
        0.012265709750020415,
        0.19897711696853243,
        0.41968231015088164,
        0.6123228018958196,
        0.9614608885959601,
        1.142382379480056,
        1.464619955511758,
        1.139238309437359,
        1.133883297085439,
        1.0914760186533556,
        0.6574148114518049,
        0.7270406335604327,
        0.44116191802455695,
        0.8240953616875615,
        0.6062400722217697,
        0.7493165281123629,
        0.808664090570953,
        0.5592000056346818,
        -0.02817865585912427,
        -0.044194714803366265,
        -0.31766947194180684,
        -0.15139743703973296,
        -0.014004146848230628,
        0.44396281656986625,
        0.6039622923791491,
        0.4298071681908666,
        0.5327253880586091,
        0.25966145715480354,
        0.2543819143901895,
        0.24133349604825916,
        0.24134518585167117,
        0.15533329004913407,
        0.4516383360782669,
        -0.05545835452574098,
        0.060406863815440366,
        0.30276422477044307,
        0.5005592974462986,
        0.6569259503674485,
        0.6678348099682139,
        0.8510533201630459,
        1.0049961789378454,
        0.935819223632456,
        0.8336771309440286,
        0.753610880222751,
        0.35444346560884427,
        0.29112261473774576,
        0.3231734579594731,
        0.4083599508141456,
        0.7989693740009628,
        0.7039965673898426,
        0.8726419516893764,
        1.0888623463807499,
        1.3434646411112157,
        1.075007277483928,
        1.1323834303643214,
        1.1967536846292222,
        0.9240556283363753,
        0.7232603080834131,
        1.016126414190726,
        0.9805429502615016,
        1.0860435613538308,
        1.1098526331546568,
        0.937897437965438,
        0.7864784131592443,
        0.9065298529292523,
        0.6494884482451874,
        0.8608740809559369,
        1.0148333108674594,
        0.7924796389261712,
        0.7206071286048312,
        0.39919787797184686,
        -0.19674415983534238,
        0.07015607868189298,
        -0.07018517968812342,
        0.01839960937372795,
        0.0817348019017904,
        0.08754349768891015,
        -0.18412117457036603,
        -0.44041634766495263,
        -0.5417358759712049,
        -0.8626334893449906,
        -1.1483579644191797,
        -0.7499088719891049,
        -0.7348247393263198,
        -1.0642275587116488,
        -1.075383500708144,
        -1.380710314878901,
        -1.7458211649550912,
        -1.8164745803150437,
        -1.5584693892232782,
        -1.5236585617681835,
        -1.3460202279396039,
        -1.6620289788143359,
        -1.7866675028551753,
        -1.85768305858333,
        -2.185958715734383,
        -2.542994807043975,
        -2.291009864709411,
        -2.2879670251170947,
        -2.462541737480625,
        -2.2445136986977445,
        -2.1818363282089104,
        -2.4496626318700585,
        -2.0871743567176844,
        -2.0088358968243285,
        -1.608644920858885,
    ];

    let failing_candidate_2 = vec![
        -0.6035390967355747,
        -0.409527508019152,
        -0.56679082150203,
        0.01679812681788141,
        -0.01966195833121064,
        0.010793125327134327,
        0.2959516924566714,
        0.3117982457017277,
        0.2862304037917113,
        0.06373449300703483,
        0.14243365358893137,
        -0.21474208152242863,
        -0.0237954640647844,
        0.4102000502052935,
        0.22528099526249293,
        0.45463270407221495,
        0.7898407112123166,
        0.3638197437593372,
        -0.021365502768005685,
        0.13130836887109457,
        0.024414691129408552,
        0.20885836070190733,
        0.42688293847512676,
        0.6171836797903266,
        0.9620812458138684,
        1.1408053215428715,
        1.459129101984827,
        1.1376994383796144,
        1.1324094663125177,
        1.0905172532596634,
        0.6617280160727406,
        0.7305081849870482,
        0.44810166183123357,
        0.8263841171103533,
        0.6111748290253262,
        0.7525135235754913,
        0.8111402693277461,
        0.5647060961958252,
        -0.015538450018267405,
        -0.03135998298067628,
        -0.30151320229110734,
        -0.13726065488925557,
        -0.0015361001066843856,
        0.45086854154947453,
        0.6089247143756115,
        0.4368848231945211,
        0.5385530309439274,
        0.2688056481027381,
        0.2635902289932312,
        0.2507002926098258,
        0.2507118404325861,
        0.16574461788821857,
        0.45845083662771735,
        -0.04248681810064303,
        0.07197113797729406,
        0.31138490314769174,
        0.5067776194855758,
        0.661245092540359,
        0.672021456585763,
        0.8530146527561068,
        1.0050877703009558,
        0.9367510163957895,
        0.8358495092306721,
        0.7567557178445828,
        0.3624364642866439,
        0.2998846884251399,
        0.3315462522512312,
        0.41569809693064624,
        0.8015633017162193,
        0.70774400474925,
        0.8743410755980967,
        1.0879353258230868,
        1.339445301679613,
        1.0742485362070737,
        1.1309278164977916,
        1.1945162500316795,
        0.9251302980042473,
        0.7267737741465584,
        1.016082821239884,
        0.9809315427991093,
        1.0851507768667799,
        1.1086706712186019,
        0.9388039893953704,
        0.7892240521306988,
        0.9078173851171939,
        0.6538979239644314,
        0.8627161336973042,
        1.0148054235402322,
        0.7951523889092312,
        0.7241528193460229,
        0.4066473037247099,
        -0.18205661074491802,
        0.08160194196622673,
        -0.057034775906582146,
        0.030474090350056788,
        0.09304003367929929,
        0.0987781788862112,
        -0.16958694026299057,
        -0.4227692333189308,
        -0.5228581667084649,
        -0.8398582592547637,
        -1.1221124153047124,
        -0.7285027594167552,
        -0.7136018338542027,
        -1.0390038308722687,
        -1.0500242763288412,
        -1.3516426876700807,
        -1.7123190169421043,
        -1.782114298285405,
        -1.5272427565695497,
        -1.4928547304048787,
        -1.3173739355451244,
        -1.6295445441686462,
        -1.7526692481525237,
        -1.8228222714217548,
        -2.1471107963612237,
        -2.499810440330452,
        -2.2508860273361866,
        -2.2478801451103054,
        -2.4203345282814936,
        -2.204954589037897,
        -2.143038478049637,
        -2.4076118482106152,
        -2.0495262408975945,
        -1.972139255138987,
        -1.5768088720816649,
        -1.2726017970739052,
        -1.4554793733777427,
    ];

    let failing_candidate_3 = vec![
        -0.8819292026654649,
        -1.3993274956048756,
        -1.3603941827931663,
        -1.2710301858845767,
        -1.6271708276229562,
        -1.2572240086958857,
        -0.8878212303504756,
        -0.8995116555085354,
        -0.7978413292417822,
        -0.7435913050602966,
        -0.8015905884748942,
        -0.5761305074029552,
        -0.7588855667376665,
        -0.0806992147192153,
        -0.12306933192710691,
        -0.08767760261809418,
        0.24370401272116105,
        0.26211922803370263,
        0.23240694255629976,
        -0.02615465376674382,
        0.06530132184006786,
        -0.3497711525822809,
        -0.12787286219026575,
        0.37647156630266426,
        0.16157788188420863,
        0.4281065733110344,
        0.8176504400757987,
        0.32257320012449214,
        -0.1250490140139891,
        0.0523726735514434,
        -0.07184803619669652,
        0.14249320480929203,
        0.39585868315849526,
        0.6170064035026007,
        1.0178104673816974,
        1.2255049915591465,
        1.5954277668964028,
        1.2218956573208117,
        1.215748202217709,
        1.1670654311849704,
        0.6687711961934542,
        0.7487003517771834,
        0.4205168755879351,
        0.8601173839884058,
        0.61002354237771,
        0.7742726665805924,
        0.842402570251488,
        0.5560224162575427,
        -0.11827741962595115,
        -0.1366635589694156,
        -0.4506075204128862,
        -0.2597303006627689,
        -0.10200534553414237,
        0.42373225529652925,
        0.6074086932612104,
        0.4074818328611807,
        0.5256300451059864,
        0.21215770457888777,
        0.20609688716569563,
        0.19111754432725045,
        0.19113096400528604,
        0.09239089899138099,
        0.4325436096819144,
        -0.14959400897407268,
        -0.01658288202340864,
        0.26163888432660765,
        0.4887039682108297,
        0.6682099927133804,
        0.68073316170247,
        0.8910646215498521,
        1.0677881752167362,
        0.9883743104183198,
        0.8711170778156855,
        0.7792025033504477,
        0.3209656966546121,
        0.24827453139879838,
        0.2850683064218399,
        0.3828608241229648,
        0.8312732149980026,
        0.7222461901680437,
        0.9158479711154158,
        1.1640649837734331,
        1.456343707545431,
        1.1481596210223897,
        1.2140263829719697,
        1.2879222439081077,
        0.9748699206650828,
        0.7443606080720618,
        1.0805654793586252,
        1.0397163211229115,
        1.1608290707148816,
        1.1881614446336173,
        0.990760062022058,
        0.8169338230558818,
        0.9547506547545715,
        0.6596718778835542,
        0.9023386732391936,
        1.0790810206681418,
        0.8238231192033574,
        0.741314807119015,
        0.3723429340140477,
        -0.31178749944007955,
        -0.005390963733896108,
        -0.16650013178899573,
        -0.06480643291633045,
        0.007901196296332642,
        0.01456947158912397,
        -0.2972965459027368,
        -0.5915186627155958,
        -0.7078316066263431,
        -1.076216129623916,
        -1.4042225406168611,
        -0.9468103544978735,
        -0.9294940492832889,
        -1.3076423914212332,
        -1.3204492064291733,
        -1.6709587400281265,
        -2.090099240739445,
        -2.1712080543634595,
        -1.8750228685281012,
        -1.8350606826695905,
        -1.6311351620478447,
        -1.9939073613488345,
        -2.1369900809215223,
        -2.218514624988016,
        -2.595369005735443,
        -3.005239832779576,
        -2.7159657811325713,
    ];

    let failing_candidate_4 = vec![
        0.5801084581639867,
        0.8605128585779351,
        0.504142630546673,
        0.18193183665100024,
        0.3096448522232841,
        0.22022736523983097,
        0.3745160918662473,
        0.5568955389671402,
        0.7160837568205282,
        1.004593557138755,
        1.1540977939912547,
        1.4203783925779752,
        1.151499695832505,
        1.1470745883944813,
        1.1120313894467027,
        0.7533454798135805,
        0.8108806866522575,
        0.574645184779544,
        0.8910817340273804,
        0.711057301127205,
        0.8292883429175191,
        0.8783301233664306,
        0.6721858037598817,
        0.1868062167304352,
        0.1735713674146205,
        -0.05241413969463656,
        0.08498453840862874,
        0.19851930367260578,
        0.5769597036212334,
        0.7091750607398143,
        0.565262202137507,
        0.6503085382270203,
        0.4246625168382707,
        0.4202997735947971,
        0.4095172302009214,
        0.4095268900546487,
        0.33845107269675945,
        0.5833023591064517,
        0.1642636734936483,
        0.2600087448016435,
        0.4602804323612811,
        0.6237281314106591,
        0.7529415100972884,
        0.7619560319297903,
        0.9133584076789403,
        1.040568887249677,
        0.983404600905512,
        0.8989996164933312,
        0.832836975155194,
        0.5029855052904635,
        0.4506604031697916,
        0.4771455754560028,
        0.547539322169806,
        0.8703189070359937,
        0.7918382527767835,
        0.9311981450438152,
        1.1098715847900587,
        1.3202618573252247,
        1.0984224667674511,
        1.1458351754954093,
        1.199027450735063,
        0.9736837693515156,
        0.8077568196493158,
        1.0497663425621404,
        1.0203619937846078,
        1.1075422854777355,
        1.1272168807530376,
        0.9851219305955897,
        0.8599970179167407,
        0.9592013678154326,
        0.7467955399671293,
        0.9214737804877611,
        1.0486977883258708,
        0.8649561229632425,
        0.8055643682647966,
        0.5399682552855939,
        0.047512333463873895,
        0.26806499572792947,
        0.15209418082363335,
        0.22529610515398366,
        0.27763305848408965,
        0.28243306663413303,
        0.0579433207922374,
        -0.15384585956021013,
        -0.23757111897334185,
        -0.5027444411740251,
        -0.7388524866433918,
        -0.409594601373743,
        -0.3971298481191046,
        -0.6693314361593817,
        -0.6785501342057363,
        -0.9308565468941401,
        -1.2325654192921547,
        -1.2909497764671647,
        -1.0777475249841235,
        -1.048981643344269,
        -0.9021904390212563,
        -1.1633238561038344,
        -1.2663187370772904,
        -1.3250023484708953,
        -1.5962725074762858,
        -1.891308813551366,
        -1.6830813867379062,
        -1.6805669402291423,
        -1.8248265249700981,
        -1.6446593408981742,
        -1.5928659779479566,
        -1.8141838929298615,
        -1.5146421818826492,
        -1.4499072982304946,
        -1.1192100097845363,
        -0.864738157524814,
        -1.0177168335717772,
        -1.3066037035969582,
        -1.3229105876450202,
        -1.3968350556177123,
        -1.5854767041443074,
        -1.4741715762295453,
        -1.141333601587445,
        -1.2635298344466528,
        -1.4528715093176652,
        -1.5079542537089956,
        -1.3596969206143614,
        -1.5507020580744582,
        -1.8193253277154668,
        -1.8461290739277276,
        -1.8607293167349752,
        -1.752213471583983,
    ];

    match candidate_no {
        2 => failing_candidate_2,
        3 => failing_candidate_3,
        4 => failing_candidate_4,
        _ => failing_candidate_1,
    }
}

pub fn make_knn_fail_query() -> Vec<f64> {
    vec![
        0.3340897059175602,
        1.330351738237077,
        1.8294226783075387,
        2.2471324255486183,
        1.7824557537475956,
        1.9521980391051645,
        1.6560067460872607,
        1.4907844168136324,
        1.1883776417051173,
        0.6441962410552153,
        0.16208037903720438,
        0.05072376217421901,
        -0.8505728539771462,
        -0.5282231450842175,
        -0.5907185503934304,
        -0.219793737318905,
        -0.07673732062660284,
        0.18549628273893906,
        -0.6013423886946005,
        -1.1426222044037317,
        -1.3797660079451424,
        -1.3215889482166503,
        -0.7227615586581437,
        -0.8765953526130663,
        -0.20730614698617456,
        0.04492048963428961,
        0.6678234428174481,
        0.7351725403256216,
        0.3867126607446516,
        -0.3992124658283756,
        -0.31672104867348166,
        0.11754416740080008,
        -0.03768231287147581,
        -0.3245851744850972,
        -0.4883285994632444,
        -1.070103116428511,
        -1.3316591069364476,
        -1.4275465718960638,
        -1.4032265372062223,
        -1.43706533030291,
        -1.1127342982453414,
        -1.054738094545063,
        -0.09235034250763519,
        0.07318733837678339,
        1.0305235640780377,
        0.6468866688872117,
        0.92623512753647,
        0.7881645054122534,
        1.1065574936666636,
        1.421654988123975,
        0.2619071891331608,
        -0.44212764878737765,
        -1.2066271113871787,
        -0.9934369634670003,
        -0.21345258929881888,
        -0.3868370061330327,
        0.04412388245461167,
        0.33354871276551656,
        -0.22437269533123347,
        -0.01350493864625855,
        -0.41240688141471143,
        0.392016636547235,
        0.3747391599025138,
        1.2426843762779887,
        1.0171785322128883,
        1.3298900103230242,
        1.2965774458917823,
        0.2238696532962006,
        -0.29717957544851453,
        0.027775413909104686,
        -0.0013432682110865728,
        -0.5948630074208062,
        -0.9271749697316352,
        -0.7947985793339815,
        -1.3216239320596148,
        -0.8043845915349692,
        -1.1442995474918198,
        -0.18464552093047823,
        -0.7575458528372373,
        -0.6518700818378529,
        -1.4588187400445871,
        -1.8427260170546214,
        -2.157462496818613,
        -1.9445419410265197,
        -1.4447129196806114,
        -1.2852964081902885,
        -1.4832212011988135,
        -1.0505809213190622,
        -0.6267482266224356,
        -0.5629758419566289,
        -0.25991242420423066,
        -0.04091218120619331,
        -0.5645240545882448,
        -0.1615510514735404,
        -0.5102153810841729,
        -0.8306116321831569,
        -0.7367362164332821,
        -0.8998757161873663,
        -0.9698102325090965,
        -0.6539557378084081,
        -0.09858061689040505,
        -0.20360340674936978,
        -0.029760647303379434,
        -0.1561864995604811,
        -0.03437869582489603,
        0.1990529403047628,
        -0.12821230681340653,
        0.01759657121584611,
        0.3364986145710296,
        0.38547065704967454,
        1.3032016322512974,
        0.9803442766886256,
        0.5893127137039592,
        -0.33904895584571676,
        0.14398843116241844,
        0.6040008466205529,
        0.5616153808445761,
        1.0382829238595062,
        1.1357429120658042,
        1.2900155033950864,
        1.3499359480095976,
        1.5833433305032,
        1.637278202251001,
        3.1160402952946313,
        2.4970906961519357,
        1.5133313100237922,
        0.908166914957359,
        0.3281165350707758,
    ]
}

// When used with the sequences from make_knn_fail_query and make_knn_fail_candidate(1) in the last row, only when matching with the last cell a start is found
pub fn make_knn_fail_cb1() -> Vec<f64> {
    vec![
        150.12509055943715,
        149.07001422232813,
        146.74060559641913,
        143.33902249543937,
        141.4355567837221,
        139.1722628663118,
        138.41726854519337,
        137.92210052198016,
        137.7610789062813,
        137.7610789062813,
        137.7610789062813,
        137.7610789062813,
        137.70947538942403,
        137.70947538942403,
        137.70947538942403,
        137.70947538942403,
        137.70947538942403,
        137.70947538942403,
        137.57145504823234,
        136.73826817628714,
        135.41591880133132,
        134.22398447332307,
        133.98100442956866,
        133.56270094717598,
        133.56270094717598,
        133.56270094717598,
        133.56270094717598,
        133.56270094717598,
        133.56270094717598,
        133.4366633436331,
        133.4366633436331,
        133.4366633436331,
        133.4366633436331,
        133.43661551669146,
        133.40749097888508,
        132.84133458952954,
        131.81315960965298,
        130.5813324326501,
        129.4028982907046,
        128.1498512029886,
        127.51772312496354,
        126.97445297053727,
        126.97445297053727,
        126.97445297053727,
        126.9318403677951,
        126.9318403677951,
        126.92140783602743,
        126.92140783602743,
        126.83266735641948,
        126.50708109293969,
        126.50708109293969,
        126.49159125515597,
        125.70134557042768,
        125.24468386782543,
        125.24468386782543,
        125.18925207713059,
        125.18925207713059,
        125.18925207713059,
        125.16072002260084,
        125.16072002260084,
        125.03330777175263,
        125.03330777175263,
        125.03330777175263,
        125.03330777175263,
        125.03330777175263,
        125.03330777175263,
        125.03330777175263,
        125.03330777175263,
        124.90543971020716,
        124.83608796202289,
        124.75055166933384,
        123.96558114666217,
        122.48133214233825,
        121.30210730260409,
        118.70115587839727,
        117.50101983940182,
        115.44058305558202,
        115.21422773666481,
        114.11452218177875,
        113.22528695598383,
        110.0497907622365,
        107.34053448794147,
        103.49611809095903,
        100.44132100702222,
        98.88389498147248,
        97.69894898407387,
        96.04392580611855,
        95.31488859085755,
        95.28016902174173,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.27971788558666,
        95.26728352979417,
        95.26728352979417,
        95.26728352979417,
        95.20530487957238,
        95.11654428728761,
        93.63871958715991,
        92.2827397999841,
        91.2223978601564,
        91.18131587256644,
        90.40900328394197,
        88.61654933435598,
        86.93579234916726,
        83.79188156391896,
        78.9520114916262,
        73.35689904301364,
        66.33104075573351,
        58.01334857829763,
        49.38164667340985,
        29.87407290196481,
        15.450876842881303,
        7.532118049964765,
        2.6530355366550356,
        0.0,
    ]
}

// When used with the sequences from make_knn_fail_query and make_knn_fail_candidate(2) in the last row, only when matching with the last cell a start is found
pub fn make_knn_fail_cb2() -> Vec<f64> {
    vec![
        151.50040716401963,
        150.6537280350319,
        148.63953516691444,
        145.42647991542145,
        144.44119529275414,
        143.09012073504795,
        142.33987713507696,
        141.84855505665485,
        141.68972337168822,
        141.68972337168822,
        141.68972337168822,
        141.68972337168822,
        141.62869769447133,
        141.62869769447133,
        141.62812515826144,
        141.62809963903516,
        141.62809963903516,
        141.62809963903516,
        141.47863984152954,
        140.6176783190913,
        139.2603975699539,
        138.03528758364308,
        137.77720379449383,
        137.33915404204046,
        137.3054778712942,
        137.3054778712942,
        137.3054778712942,
        137.3054778712942,
        137.3054778712942,
        137.29593272519847,
        137.29570144660687,
        137.29570144660687,
        137.29570144660687,
        137.29516913070594,
        137.26026913808536,
        136.66953868197163,
        135.60833809711406,
        134.34038694765016,
        133.12661467532038,
        131.83713603988824,
        131.17905637336705,
        130.61170863505606,
        130.61170863505606,
        130.61170863505606,
        130.5700357212478,
        130.5700357212478,
        130.5567888948617,
        130.5567888948617,
        130.5464927901018,
        130.372964543137,
        130.372964543137,
        130.35319212057354,
        129.53396093213436,
        128.80092306076455,
        128.77169376584317,
        128.65311671384524,
        128.65311671384524,
        128.65311671384524,
        128.6200342415093,
        128.6200342415093,
        128.483193388267,
        128.483193388267,
        128.483193388267,
        128.483193388267,
        128.483193388267,
        128.483193388267,
        128.483193388267,
        128.47741510270137,
        128.1209293675064,
        128.04688591022875,
        127.95614762836952,
        127.15557418914788,
        125.64989878447206,
        124.45156732776027,
        121.82227712145391,
        120.60286647879029,
        118.51719837151924,
        118.28242884774104,
        117.09630723437502,
        116.87558253675462,
        115.2454610019408,
        112.48763812488778,
        108.58540971015319,
        105.47905517069535,
        103.88475421620024,
        102.66761616553293,
        101.54305778935262,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.26456648361882,
        101.25451145584127,
        101.25451145584127,
        101.25451145584127,
        101.19800045029909,
        100.88991151396458,
        97.91093608516734,
        95.65131849933235,
        93.95373218109366,
        93.81344232266922,
        93.07798126001794,
        91.34190443642368,
        88.77992257550662,
        84.41889561314812,
        78.61877137510689,
        72.05176394644391,
        65.17405972205624,
        57.01763715032483,
        48.550235539853716,
        29.290056124944833,
        15.07947463146158,
        7.318051354238548,
        2.5622991788640492,
        0.0,
    ]
}

// When used with the sequences from make_knn_fail_query and make_knn_fail_candidate(3) there was a discrepancy between ucr and ucr_improved.
// The reason was that ucr did not correctly check if the row was pruned in the last row
pub fn make_knn_fail_cb3() -> Vec<f64> {
    vec![
        127.87306832274803,
        125.88200353090916,
        122.23343788468905,
        116.81463773925702,
        114.44688081874514,
        111.59051443111241,
        109.6475920181269,
        108.13797387200728,
        107.28001922311019,
        107.13403637923075,
        107.13403637923075,
        107.13403637923075,
        107.13403637923075,
        107.13403637923075,
        107.13403637923075,
        107.13403637923075,
        107.13403637923075,
        107.13403637923075,
        107.13403637923075,
        107.07493364024663,
        106.74064682456702,
        106.47024853043291,
        106.47024853043291,
        106.45639293674208,
        106.45639293674208,
        106.45639293674208,
        106.45639293674208,
        106.45639293674208,
        106.45639293674208,
        106.45394849328657,
        106.45394849328657,
        106.45394849328657,
        106.45394849328657,
        106.45394849328657,
        106.32402015475357,
        105.43089289826305,
        103.97498498192071,
        102.30860602885814,
        101.40112303770184,
        100.42802402700882,
        99.98961215708603,
        99.62463840648475,
        99.62463840648475,
        99.62463840648475,
        99.62463840648475,
        99.62463840648475,
        99.62463840648475,
        99.62463840648475,
        99.62463840648475,
        99.58473461624182,
        99.58473461624182,
        99.58473461624182,
        99.01316899430488,
        98.71850519005844,
        98.71850519005844,
        98.71850519005844,
        98.71850519005844,
        98.71850519005844,
        98.71850519005844,
        98.71850519005844,
        98.71850519005844,
        98.71850519005844,
        98.71850519005844,
        98.68791650891278,
        98.68791650891278,
        98.6192191369467,
        98.56687460657068,
        98.56687460657068,
        98.5450931071391,
        98.5450931071391,
        98.5450931071391,
        98.34682862616134,
        97.74219647562869,
        97.32590753801537,
        95.95225339740747,
        95.52350269039704,
        94.25175781282185,
        94.06433804111306,
        93.05266339576833,
        92.24240307102937,
        89.32823563362209,
        84.95595233998958,
        79.16838169105324,
        74.35993760931342,
        71.49373109980107,
        69.14189127304891,
        66.14381380104517,
        64.45678831399024,
        63.62537892405736,
        63.562283340641144,
        63.562283340641144,
        63.562283340641144,
        63.49840757433298,
        63.49840757433298,
        63.45903395011922,
        63.189855469402616,
        63.16876733149487,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        63.131886391477785,
        62.90208263270573,
        62.844947545383,
        62.79787166008431,
        62.79787166008431,
        62.78112239298728,
        62.43369304711584,
        62.134433820282716,
        61.086444587923374,
        59.82941470429306,
        57.309855162447,
        53.54060915694089,
        48.29112656441032,
        41.702806773163914,
        25.33645864000441,
        13.594975622355022,
        7.627579886281254,
        2.717769004047277,
        0.0,
    ]
}

// When used with the sequences from make_knn_fail_query and make_knn_fail_candidate(4), ucr and ucr_improved will early abandon at the very last cell because the cb does not end with and the naive implementation.
// For some reason ucr/ucr_improved wrongfully abandon early
// The reason is currently unknown
pub fn make_knn_fail_cb4() -> Vec<f64> {
    vec![
        127.11386250488027,
        127.11386250488027,
        126.94654527719227,
        126.26302304615905,
        126.13192303068749,
        125.84909089425518,
        125.79357017327769,
        125.78861316502902,
        125.78861316502902,
        125.78861316502902,
        125.78821908465963,
        125.77100352585173,
        124.72213213964157,
        124.49573793003175,
        124.20596629145398,
        124.17795036175312,
        124.17735874462247,
        124.17735874462247,
        123.8760365220723,
        122.68748289771554,
        120.92561991556744,
        119.31481522098055,
        118.86544955886951,
        118.18617488714182,
        118.16218335321902,
        118.16218335321902,
        118.16218335321902,
        118.16218335321902,
        118.16218335321902,
        118.04191427420986,
        117.9720561320759,
        117.9720561320759,
        117.9720561320759,
        117.897979059897,
        117.70795764366164,
        116.672266790296,
        115.0357991040825,
        113.14480989799029,
        110.93003769240757,
        108.36578311400748,
        106.735059294182,
        105.24909398370049,
        105.18324323049218,
        105.17494833167386,
        105.17494833167386,
        105.17494833167386,
        105.17494833167386,
        105.17494833167386,
        105.17494833167386,
        105.16466776470068,
        105.16466776470068,
        104.67167224949849,
        101.92507034359207,
        99.83965313926475,
        99.39860707249915,
        98.6972051619102,
        98.531933219235,
        98.51821807120565,
        98.06254838713376,
        97.84709892259055,
        97.10221378487049,
        97.09877469350681,
        97.09301065832756,
        97.09301065832756,
        97.09301065832756,
        97.09291795699741,
        97.09291795699741,
        97.09291795699741,
        96.97410544492774,
        96.97371589893423,
        96.9713290291192,
        96.7768329044121,
        96.30127943343143,
        96.21598381381507,
        95.87636125622255,
        95.87206679945103,
        95.7076794803004,
        95.7076794803004,
        95.70733003836074,
        95.70733003836074,
        95.65613947320924,
        95.3516824535324,
        94.60083815900154,
        94.17365544142815,
        94.15001233721728,
        94.15001233721728,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.11304403644894,
        94.0239123929817,
        93.80700979560356,
        93.38608199728854,
        92.88403654528453,
        92.19453970964996,
        91.0628882098285,
        90.52041788106234,
        89.74190330752049,
        88.29893352488524,
        86.7359114448455,
        82.035948512751,
        78.63161932370801,
        76.51735538758686,
        76.24100625082485,
        75.22347692010027,
        73.06628265780235,
        71.03179824138347,
        67.41030900519033,
        63.4083844953999,
        58.765421156152186,
        53.86063976242754,
        47.867536790402085,
        41.607450925816266,
        25.760853835384687,
        13.406981864382178,
        6.359736071442281,
        2.1592837041248636,
        0.0000000000000000,
    ]
}
